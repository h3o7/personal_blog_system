<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="blogsystem.mapper.CommentMapper">

    <select id="selectHotCommentsByArticleId" resultType="blogsystem.entity.Comment">
        SELECT c.*
        FROM comment c
        WHERE c.article_id = #{articleId}
          AND c.comment_id NOT IN (
            SELECT cr.second_comment_id
            FROM comment_reply cr
        )
        ORDER BY c.comment_good_number DESC, c.comment_time DESC
            LIMIT #{limit}
    </select>

    <select id="selectHotCommentsByCommentId" resultType="blogsystem.entity.Comment">
        SELECT c.*
        FROM comment c
        WHERE c.comment_id IN (
            SELECT cr.second_comment_id
            FROM comment_reply cr
            WHERE cr.first_comment_id = #{commentId}
        )
        ORDER BY c.comment_good_number DESC, c.comment_time DESC
            LIMIT #{limit}
    </select>

</mapper>
